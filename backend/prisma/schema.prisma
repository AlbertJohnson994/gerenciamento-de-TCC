generator client {
  provider = "prisma-client-js"
  seed     = "ts-node --transpile-only prisma/seed.ts"
}

  
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String   @id @default(cuid())
  email         String   @unique
  password      String
  name          String
  role          UserRole @default(STUDENT)
  matriculation String?  @unique
  course        String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  // Relationships
  proposals    Proposal[] @relation("StudentProposals")
  orientations Proposal[] @relation("OrientadorProposals")
  userProposals Proposal[] @relation("UserProposals")
  

  @@map("users")
}

enum UserRole {
  STUDENT
  ORIENTADOR
  COORDENADOR
  ADMIN
}

model Proposal {
  id           String         @id @default(cuid())
  title        String
  description  String
  status       ProposalStatus @default(PENDING)
  studentId    String
  orientadorId String?
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  deadline     DateTime?
  feedback     String?

  // Relationships
  student    User    @relation("StudentProposals", fields: [studentId], references: [id])
  orientador User?   @relation("OrientadorProposals", fields: [orientadorId], references: [id])
  user       User?   @relation("UserProposals", fields: [userId], references: [id])
  userId     String?

  @@map("proposals")
}

enum ProposalStatus {
  PENDING
  APPROVED
  REJECTED
  REVISION
  COMPLETED
}
